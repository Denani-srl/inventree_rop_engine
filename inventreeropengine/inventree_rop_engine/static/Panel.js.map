{"version":3,"file":"Panel.js","sources":["../../frontend/node_modules/@tabler/icons-react/dist/esm/icons/IconChartLine.mjs","../../frontend/node_modules/@tabler/icons-react/dist/esm/icons/IconTrendingUp.mjs","../../frontend/src/Panel.tsx"],"sourcesContent":["/**\n * @license @tabler/icons-react v3.35.0 - MIT\n *\n * This source code is licensed under the MIT license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createReactComponent from '../createReactComponent.mjs';\n\nconst __iconNode = [[\"path\", { \"d\": \"M4 19l16 0\", \"key\": \"svg-0\" }], [\"path\", { \"d\": \"M4 15l4 -6l4 2l4 -5l4 4\", \"key\": \"svg-1\" }]];\nconst IconChartLine = createReactComponent(\"outline\", \"chart-line\", \"ChartLine\", __iconNode);\n\nexport { __iconNode, IconChartLine as default };\n//# sourceMappingURL=IconChartLine.mjs.map\n","/**\n * @license @tabler/icons-react v3.35.0 - MIT\n *\n * This source code is licensed under the MIT license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createReactComponent from '../createReactComponent.mjs';\n\nconst __iconNode = [[\"path\", { \"d\": \"M3 17l6 -6l4 4l8 -8\", \"key\": \"svg-0\" }], [\"path\", { \"d\": \"M14 7l7 0l0 7\", \"key\": \"svg-1\" }]];\nconst IconTrendingUp = createReactComponent(\"outline\", \"trending-up\", \"TrendingUp\", __iconNode);\n\nexport { __iconNode, IconTrendingUp as default };\n//# sourceMappingURL=IconTrendingUp.mjs.map\n","import { useEffect, useState } from 'react';\nimport { Alert, Badge, Card, Group, LoadingOverlay, SimpleGrid, Stack, Text, Title } from '@mantine/core';\nimport { IconAlertTriangle, IconChartLine, IconTrendingUp } from '@tabler/icons-react';\n\n// Import for type checking\nimport { checkPluginVersion, type InvenTreePluginContext } from '@inventreedb/ui';\n\ninterface ROPDetails {\n    part_id: number;\n    part_name: string;\n    current_stock: number;\n    reorder_point: number;\n    safety_stock: number;\n    max_stock: number;\n    demand_rate: number;\n    lead_time_days: number;\n    suggested_order_qty: number;\n    days_until_stockout: number | null;\n    urgency_score: number;\n    status: string;\n    last_calculated: string;\n}\n\n/**\n * Render ROP Analysis Panel on Part Detail Page\n */\nfunction ROPAnalysisPanel({\n    context\n}: {\n    context: InvenTreePluginContext;\n}) {\n    const [ropData, setRopData] = useState<ROPDetails | null>(null);\n    const [loading, setLoading] = useState<boolean>(true);\n    const [error, setError] = useState<string | null>(null);\n\n    const apiUrl = context.context?.api_url;\n    const partId = context.context?.part_id;\n\n    useEffect(() => {\n        if (!apiUrl || !partId) {\n            setError('Configuration error: Missing API URL or Part ID');\n            setLoading(false);\n            return;\n        }\n\n        // Fetch ROP details for this part\n        fetch(apiUrl, {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            credentials: 'same-origin'\n        })\n            .then(response => {\n                if (!response.ok) {\n                    throw new Error(`HTTP error! status: ${response.status}`);\n                }\n                return response.json();\n            })\n            .then(data => {\n                setRopData(data);\n                setLoading(false);\n            })\n            .catch(err => {\n                console.error('Error fetching ROP details:', err);\n                setError(`Failed to load ROP data: ${err.message}`);\n                setLoading(false);\n            });\n    }, [apiUrl, partId]);\n\n    const getStatusColor = (status: string): string => {\n        switch (status.toLowerCase()) {\n            case 'critical': return 'red';\n            case 'low': return 'orange';\n            case 'adequate': return 'green';\n            case 'excess': return 'blue';\n            default: return 'gray';\n        }\n    };\n\n    if (loading) {\n        return (\n            <div style={{ position: 'relative', minHeight: 200 }}>\n                <LoadingOverlay visible={true} />\n                <Text ta=\"center\" mt=\"xl\">Loading ROP analysis...</Text>\n            </div>\n        );\n    }\n\n    if (error) {\n        return (\n            <Alert icon={<IconAlertTriangle size=\"1rem\" />} title=\"Error\" color=\"red\">\n                {error}\n            </Alert>\n        );\n    }\n\n    if (!ropData) {\n        return (\n            <Alert icon={<IconAlertTriangle size=\"1rem\" />} title=\"No Data\" color=\"yellow\">\n                <Text>No ROP analysis available for this part. Ensure sufficient stock history exists.</Text>\n            </Alert>\n        );\n    }\n\n    return (\n        <Stack gap=\"md\">\n            <Group justify=\"space-between\">\n                <Title order={3}>\n                    <IconChartLine size=\"1.5rem\" style={{ marginRight: 8, verticalAlign: 'middle' }} />\n                    Reorder Point Analysis\n                </Title>\n                <Badge size=\"lg\" color={getStatusColor(ropData.status)}>\n                    {ropData.status}\n                </Badge>\n            </Group>\n\n            <SimpleGrid cols={2} spacing=\"md\">\n                <Card shadow=\"sm\" padding=\"lg\" radius=\"md\" withBorder>\n                    <Text size=\"sm\" c=\"dimmed\">Current Stock</Text>\n                    <Text size=\"xl\" fw={700}>{Math.round(ropData.current_stock)}</Text>\n                </Card>\n\n                <Card shadow=\"sm\" padding=\"lg\" radius=\"md\" withBorder>\n                    <Text size=\"sm\" c=\"dimmed\">Reorder Point</Text>\n                    <Text size=\"xl\" fw={700} c=\"blue\">{Math.round(ropData.reorder_point)}</Text>\n                </Card>\n\n                <Card shadow=\"sm\" padding=\"lg\" radius=\"md\" withBorder>\n                    <Text size=\"sm\" c=\"dimmed\">Safety Stock</Text>\n                    <Text size=\"xl\" fw={700}>{Math.round(ropData.safety_stock)}</Text>\n                </Card>\n\n                <Card shadow=\"sm\" padding=\"lg\" radius=\"md\" withBorder>\n                    <Text size=\"sm\" c=\"dimmed\">Max Stock Level</Text>\n                    <Text size=\"xl\" fw={700}>{Math.round(ropData.max_stock)}</Text>\n                </Card>\n            </SimpleGrid>\n\n            <Card shadow=\"sm\" padding=\"lg\" radius=\"md\" withBorder>\n                <Stack gap=\"sm\">\n                    <Group justify=\"space-between\">\n                        <Text fw={600}>Demand Analysis</Text>\n                        <IconTrendingUp size=\"1.2rem\" />\n                    </Group>\n\n                    <Group justify=\"space-between\">\n                        <Text size=\"sm\">Daily Demand Rate:</Text>\n                        <Text fw={600}>{ropData.demand_rate.toFixed(2)} units/day</Text>\n                    </Group>\n\n                    <Group justify=\"space-between\">\n                        <Text size=\"sm\">Lead Time:</Text>\n                        <Text fw={600}>{ropData.lead_time_days} days</Text>\n                    </Group>\n\n                    {ropData.days_until_stockout !== null && (\n                        <Group justify=\"space-between\">\n                            <Text size=\"sm\">Days Until Stockout:</Text>\n                            <Text\n                                fw={700}\n                                c={ropData.days_until_stockout <= 7 ? 'red' : ropData.days_until_stockout <= 14 ? 'orange' : 'green'}\n                            >\n                                {ropData.days_until_stockout <= 0 ? 'NOW' : `${Math.round(ropData.days_until_stockout)} days`}\n                            </Text>\n                        </Group>\n                    )}\n\n                    <Group justify=\"space-between\">\n                        <Text size=\"sm\">Urgency Score:</Text>\n                        <Badge color={ropData.urgency_score >= 80 ? 'red' : ropData.urgency_score >= 60 ? 'orange' : 'green'}>\n                            {Math.round(ropData.urgency_score)}\n                        </Badge>\n                    </Group>\n                </Stack>\n            </Card>\n\n            {ropData.suggested_order_qty > 0 && (\n                <Alert icon={<IconAlertTriangle size=\"1rem\" />} title=\"Reorder Recommended\" color=\"orange\">\n                    <Text>\n                        Suggested Order Quantity: <Text component=\"span\" fw={700} c=\"green\">{Math.round(ropData.suggested_order_qty)}</Text> units\n                    </Text>\n                    <Text size=\"sm\" c=\"dimmed\" mt=\"xs\">\n                        Last calculated: {new Date(ropData.last_calculated).toLocaleString()}\n                    </Text>\n                </Alert>\n            )}\n        </Stack>\n    );\n}\n\n// This is the function which is called by InvenTree to render the actual panel\nexport function renderROPAnalysisPanel(context: InvenTreePluginContext) {\n    checkPluginVersion(context);\n    return <ROPAnalysisPanel context={context} />;\n}\n"],"names":["__iconNode","IconChartLine","createReactComponent","IconTrendingUp","useEffect","Alert","ROPAnalysisPanel","context","ropData","setRopData","useState","loading","setLoading","error","setError","apiUrl","api_url","partId","part_id","fetch","method","headers","credentials","then","response","ok","Error","status","json","data","catch","err","console","message","getStatusColor","toLowerCase","position","minHeight","LoadingOverlay","Text","IconAlertTriangle","Stack","Group","Title","marginRight","verticalAlign","Badge","SimpleGrid","Card","Math","round","current_stock","reorder_point","safety_stock","max_stock","demand_rate","toFixed","lead_time_days","days_until_stockout","urgency_score","suggested_order_qty","Date","last_calculated","toLocaleString","renderROPAnalysisPanel","checkPluginVersion"],"mappings":"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","x_google_ignoreList":[0,1]}